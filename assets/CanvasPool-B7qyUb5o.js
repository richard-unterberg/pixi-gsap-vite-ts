import{M as u,B as v}from"./colorToUniform-B1_ibuy7.js";import{T as p,D as C,n as r}from"./index-C3DFkwyY.js";const l={};function P(n,e){let t=0;for(let a=0;a<e;a++)t=t*31+n[a].uid>>>0;return l[t]||d(n,t)}function d(n,e){const t={};let a=0;for(let s=0;s<u;s++){const c=s<n.length?n[s]:p.EMPTY.source;t[a++]=c.source,t[a++]=c.style}const o=new v(t);return l[e]=o,o}class h{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const a=C.get().createCanvas();a.width=e,a.height=t;const o=a.getContext("2d");return{canvas:a,context:o}}getOptimalCanvasAndContext(e,t,a=1){e=Math.ceil(e*a-1e-6),t=Math.ceil(t*a-1e-6),e=r(e),t=r(t);const o=(e<<17)+(t<<1);this._canvasPool[o]||(this._canvasPool[o]=[]);let s=this._canvasPool[o].pop();return s||(s=this._createCanvasAndContext(e,t)),s}returnCanvasAndContext(e){const{width:t,height:a}=e.canvas,o=(t<<17)+(a<<1);this._canvasPool[o].push(e)}clear(){this._canvasPool={}}}const f=new h;export{f as C,P as g};
